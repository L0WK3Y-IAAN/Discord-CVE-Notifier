import requests
import json

# URL of the JSON data
url = "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"

# Fetch the JSON data
response = requests.get(url)

# Check if the request was successful
if response.status_code == 200:
    # Parse the JSON data
    json_data = response.json()

    # Check the structure of the JSON data
    print("Type of json_data:", type(json_data))

    # Now you can work with the JSON data accordingly
    if isinstance(json_data, list):
        # If it's a list, you can iterate through it
        for vulnerability in json_data[:5]:
            print(vulnerability)
    elif isinstance(json_data, dict):
        # If it's a dictionary, you might want to iterate through its items or access specific keys
        for key, value in json_data.items():
            print(f"{key}: {value}")
    else:
        print("Unhandled JSON data structure.")
else:
    print("Failed to fetch data:", response.status_code)
